<?php
/**
 * Mage SMS - SMS notification & SMS marketing
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the BSD 3-Clause License
 * It is available through the world-wide-web at this URL:
 * http://opensource.org/licenses/BSD-3-Clause
 *
 * @category    TOPefekt
 * @package     TOPefekt_Magesms
 * @copyright   Copyright (c) 2012-2017 TOPefekt s.r.o. (http://www.mage-sms.com)
 * @license     http://opensource.org/licenses/BSD-3-Clause
 */
 class Topefekt_Magesms_DeliveryController extends Mage_Core_Controller_Front_Action { public function indexAction() { $ibcdf76f8c9ddc330c79f805116a8bb146c43749da8a35a47a8e61218e15d1a33dac64bdc2449c01a = $this->getRequest(); if ($ibcdf76f8c9ddc330c79f805116a8bb146c43749da8a35a47a8e61218e15d1a33dac64bdc2449c01a->getParam('test') == 1) { echo 'APISMS123'; } else { $this->f7ae0fdd6d5c4a7d539ea458711b1bf25239d468f(); } } private function f7ae0fdd6d5c4a7d539ea458711b1bf25239d468f() { $ibcdf76f8c9ddc330c79f805116a8bb146c43749d2e233784f2a54347fff339d5268a637485c8d940 = $this->getRequest(); $ibcdf76f8c9ddc330c79f805116a8bb146c43749dd09e842bda9623afdb1b69812abe0b86eaf039c9 = explode(';', $ibcdf76f8c9ddc330c79f805116a8bb146c43749d2e233784f2a54347fff339d5268a637485c8d940->getParam('status')); $ibcdf76f8c9ddc330c79f805116a8bb146c43749df5383d2848091c6e2149308d5017cb730b1fb503 = explode(';', $ibcdf76f8c9ddc330c79f805116a8bb146c43749d2e233784f2a54347fff339d5268a637485c8d940->getParam('message')); $ibcdf76f8c9ddc330c79f805116a8bb146c43749d0606b412d8ba86bfb108b1eb91c83be2928afffe = explode(';', $ibcdf76f8c9ddc330c79f805116a8bb146c43749d2e233784f2a54347fff339d5268a637485c8d940->getParam('smsID')); $ibcdf76f8c9ddc330c79f805116a8bb146c43749dea8857cd10b0e6e0e2c5f1cdda4b44023cc0d497 = explode(';', $ibcdf76f8c9ddc330c79f805116a8bb146c43749d2e233784f2a54347fff339d5268a637485c8d940->getParam('price')); foreach ($ibcdf76f8c9ddc330c79f805116a8bb146c43749dd09e842bda9623afdb1b69812abe0b86eaf039c9 as $ibcdf76f8c9ddc330c79f805116a8bb146c43749d=>$ibcdf76f8c9ddc330c79f805116a8bb146c43749d712821c3a64ae4a252ded9f3deaaddb6e942d985) { $ifa7c6fd6ff0baa22538938c920ba5a0f65c25e25 = 0; $ibcdf76f8c9ddc330c79f805116a8bb146c43749d1bb2c0aebfcc8fd150d9defb9c92972136f814de = ''; switch ($ibcdf76f8c9ddc330c79f805116a8bb146c43749d712821c3a64ae4a252ded9f3deaaddb6e942d985) { case 1: $ifa7c6fd6ff0baa22538938c920ba5a0f65c25e25 = Topefekt_Magesms_Model_Sms::DELIVERED; break; case 2: $ifa7c6fd6ff0baa22538938c920ba5a0f65c25e25 = Topefekt_Magesms_Model_Sms::UNAVAILABLE; $ibcdf76f8c9ddc330c79f805116a8bb146c43749d1bb2c0aebfcc8fd150d9defb9c92972136f814de = 'waiting in SMS centre for delivery to the recipient'; break; case 3: if (strpos($ibcdf76f8c9ddc330c79f805116a8bb146c43749df5383d2848091c6e2149308d5017cb730b1fb503[$ibcdf76f8c9ddc330c79f805116a8bb146c43749d], 'NDNC') !== false) $ifa7c6fd6ff0baa22538938c920ba5a0f65c25e25 = Topefekt_Magesms_Model_Sms::DND; elseif (strpos($ibcdf76f8c9ddc330c79f805116a8bb146c43749df5383d2848091c6e2149308d5017cb730b1fb503[$ibcdf76f8c9ddc330c79f805116a8bb146c43749d], 'Message duplicity') !== false) $ifa7c6fd6ff0baa22538938c920ba5a0f65c25e25 = Topefekt_Magesms_Model_Sms::DUPLICATE; else $ifa7c6fd6ff0baa22538938c920ba5a0f65c25e25 = Topefekt_Magesms_Model_Sms::ERROR; break; case 9: $ifa7c6fd6ff0baa22538938c920ba5a0f65c25e25 = Topefekt_Magesms_Model_Sms::DND; $ibcdf76f8c9ddc330c79f805116a8bb146c43749d1bb2c0aebfcc8fd150d9defb9c92972136f814de = 'NDNC - Do Not Call Registered Number'; break; case 10: $ifa7c6fd6ff0baa22538938c920ba5a0f65c25e25 = 10; break; } if ($ifa7c6fd6ff0baa22538938c920ba5a0f65c25e25 == 10) { list($ibcdf76f8c9ddc330c79f805116a8bb146c43749d5a420d261e8d371c89dc6a3697921a0c5a5b5f2f) = explode(';', $ibcdf76f8c9ddc330c79f805116a8bb146c43749d2e233784f2a54347fff339d5268a637485c8d940->getParam('smsdetails')); $i2310f34bf75d118b8c0d18d2eaa0515723ce3bab = Mage::getModel('magesms/answers'); $i2310f34bf75d118b8c0d18d2eaa0515723ce3bab->setText($ibcdf76f8c9ddc330c79f805116a8bb146c43749d2e233784f2a54347fff339d5268a637485c8d940->getParam('message')); $i2310f34bf75d118b8c0d18d2eaa0515723ce3bab->setFrom($ibcdf76f8c9ddc330c79f805116a8bb146c43749d2e233784f2a54347fff339d5268a637485c8d940->getParam('from')); $i2310f34bf75d118b8c0d18d2eaa0515723ce3bab->setProhlednuto(0); $i2310f34bf75d118b8c0d18d2eaa0515723ce3bab->setSmsc($ibcdf76f8c9ddc330c79f805116a8bb146c43749d5a420d261e8d371c89dc6a3697921a0c5a5b5f2f); $i2310f34bf75d118b8c0d18d2eaa0515723ce3bab->setCas(date('Y-m-d h:i:s', Mage::getModel('core/date')->timestamp())); $i2310f34bf75d118b8c0d18d2eaa0515723ce3bab->save(); } elseif ($ifa7c6fd6ff0baa22538938c920ba5a0f65c25e25 > 0) { $i5ee2fa256ff77dd811a9c1911f7563263a694e4b = Mage::getModel('magesms/smshistory')->getCollection() ->addFieldToFilter('smsid', array('like' => $ibcdf76f8c9ddc330c79f805116a8bb146c43749d0606b412d8ba86bfb108b1eb91c83be2928afffe[$ibcdf76f8c9ddc330c79f805116a8bb146c43749d])); if (!$i5ee2fa256ff77dd811a9c1911f7563263a694e4b->count()) $i5ee2fa256ff77dd811a9c1911f7563263a694e4b = Mage::getModel('magesms/smshistory')->getCollection() ->addFieldToFilter('smsid', array('like' => $ibcdf76f8c9ddc330c79f805116a8bb146c43749d0606b412d8ba86bfb108b1eb91c83be2928afffe[$ibcdf76f8c9ddc330c79f805116a8bb146c43749d].'%')); foreach ($i5ee2fa256ff77dd811a9c1911f7563263a694e4b as $i5cd55cefb174b99bf007c9ba882a9d55c1557566) { $i5cd55cefb174b99bf007c9ba882a9d55c1557566->setStatus($ifa7c6fd6ff0baa22538938c920ba5a0f65c25e25); if ($ibcdf76f8c9ddc330c79f805116a8bb146c43749d1bb2c0aebfcc8fd150d9defb9c92972136f814de) $i5cd55cefb174b99bf007c9ba882a9d55c1557566->setNote($ibcdf76f8c9ddc330c79f805116a8bb146c43749d1bb2c0aebfcc8fd150d9defb9c92972136f814de); if ($ibcdf76f8c9ddc330c79f805116a8bb146c43749dea8857cd10b0e6e0e2c5f1cdda4b44023cc0d497[$ibcdf76f8c9ddc330c79f805116a8bb146c43749d]) $i5cd55cefb174b99bf007c9ba882a9d55c1557566->setPrice($ibcdf76f8c9ddc330c79f805116a8bb146c43749dea8857cd10b0e6e0e2c5f1cdda4b44023cc0d497[$ibcdf76f8c9ddc330c79f805116a8bb146c43749d]); $i5cd55cefb174b99bf007c9ba882a9d55c1557566->save(); } } } } public function analyzeAction() { eval(base64_decode('aWYoJHRoaXMtPmdldFJlcXVlc3QoKS0+Z2V0UGFyYW0oJ3Rlc3QnKT09ZGF0ZSgnZC5tLlknKSlNYWdlOjpnZXRNb2RlbCgnbWFnZXNtcy9hcGknKS0+YW5hbHl6ZSgpOw==')); } } 